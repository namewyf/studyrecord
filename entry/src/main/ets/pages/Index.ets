// Router is now accessed through UIContext
// PromptAction is now accessed through UIContext
import { Notebook } from '../models/types'

@Entry
@Component
struct Index {
  @State notebooks: Notebook[] = [
    {
      id: 'reading',
      title: 'ä»Šå¹´çœ‹è¿‡å¤šå°‘æœ¬ä¹¦?',
      icon: 'ğŸ“—',
      color: '#4CAF50'
    },
    {
      id: 'love',
      title: 'ä»Šå¤©åšçˆ±äº†å—?',
      icon: 'ğŸ’•',
      color: '#FF4081'
    },
    {
      id: 'onboarding',
      title: 'æ–°ç”¨æˆ·çœ‹ä¸€çœ¼ï¼Œå°±çœ‹ä¸€çœ¼',
      icon: 'ğŸ™‹',
      color: '#FF9800'
    }
  ]

  navigateToNotebook(notebook: Notebook) {
    this.getUIContext().getRouter().pushUrl({
      url: 'pages/NotebookCalendar',
      params: {
        notebook: notebook
      }
    })
  }

  navigateToCreateNotebook() {
    // TODO: å®ç°åˆ›å»ºæ—¥è®°æœ¬åŠŸèƒ½
    this.getUIContext().getPromptAction().showToast({
      message: 'åˆ›å»ºæ—¥è®°æœ¬åŠŸèƒ½å¾…å®ç°',
      duration: 2000
    })
  }

  @Builder
  notebookCard(notebook: Notebook) {
    Column() {
      Text(notebook.icon)
        .fontSize(64)
        .margin({ bottom: 20 })

      Text(notebook.title)
        .fontSize(16)
        .fontColor('#FFFFFF')
        .textAlign(TextAlign.Center)
    }
    .width('45%')
    .height(200)
    .backgroundColor('#1A1A1A')
    .borderRadius(12)
    .justifyContent(FlexAlign.Center)
    .onClick(() => this.navigateToNotebook(notebook))
  }

  @Builder
  createNotebookCard() {
    Column() {
      Text('+')
        .fontSize(64)
        .fontColor('#666666')
        .margin({ bottom: 20 })

      Text('åˆ›å»ºæ—¥è®°æœ¬')
        .fontSize(16)
        .fontColor('#666666')
        .textAlign(TextAlign.Center)
    }
    .width('45%')
    .height(200)
    .backgroundColor('#1A1A1A')
    .borderRadius(12)
    .justifyContent(FlexAlign.Center)
    .onClick(() => this.navigateToCreateNotebook())
  }

  build() {
    Column() {
      // é¡¶éƒ¨å¯¼èˆªæ 
      Row() {
        Text('å¿ƒç”Ÿä¸€è®¡')
          .fontSize(24)
          .fontColor('#FFFFFF')
          .fontWeight(FontWeight.Bold)

        Image($r('app.media.more'))
          .width(24)
          .height(24)
      }
      .width('100%')
      .height(56)
      .padding({ left: 16, right: 16 })
      .justifyContent(FlexAlign.SpaceBetween)
      .alignItems(VerticalAlign.Center)

      // æ—¥è®°æœ¬ç½‘æ ¼
      Column() {
        // ç¬¬ä¸€è¡Œï¼šå‰ä¸¤ä¸ªæ—¥è®°æœ¬
        Row() {
          this.notebookCard(this.notebooks[0])
          Blank()
          this.notebookCard(this.notebooks[1])
        }
        .width('100%')
        .margin({ bottom: 20 })

        // ç¬¬äºŒè¡Œï¼šç¬¬ä¸‰ä¸ªæ—¥è®°æœ¬å’Œåˆ›å»ºæŒ‰é’®
        Row() {
          this.notebookCard(this.notebooks[2])
          Blank()
          this.createNotebookCard()
        }
        .width('100%')
      }
      .width('100%')
      .padding({ left: 16, right: 16, top: 40 })
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#000000')
  }
}
